<?php

$sNonce=rand(0,PHP_INT_MAX);
session_start();
$_SESSION['nonce']=$sNonce;

$sTitle='Client Side Password Hashing';
require('header.php');
?>

<p>
    This web site was created to demonstrate the code used to hash passwords on the client before submitting them.
    Please do not use any passwords you would use on another site. The intend is to allow you to experiment with this
    feature.

</p>
<p>
    When you loaded the page, the server created a &quot;none&quot; and stored it in your session. It is also
    included as a hidden value in this form. Each time you load the form, a new nonce will be created. Once you submit
    the form, the password will be hashed using the nonce and the clear text password will not be submitted.
    In case you don't have Javascript enabled, the original password will be submitted to allow you to still
    support users without Javascript.
</p>
<div>
    <form action="hashpassword.php" method="POST" onsubmit="passwordhash('username','password','','cryptopassword')" >
        <label for="username">Username</label>
        <input type="text" name="username" id="username" value="" required pattern="[A-Za-z0-9]+" >
        <label for="password">Password</label>
        <input type="password" name="password" id="password" value="" autocomplete="off">
        <input type="hidden" id="cryptopassword" name="cryptopassword" value="x">
        <input type="hidden" id="nonce" name="nonce" value="<?php echo($sNonce); ?>">
        <input type="submit" value="Submit">
    </form>
</div>
<div>
    The source code for this site can be found at GitHub:
    <a href=https://github.com/jullrich/authonthemove">https://github.com/jullrich/authonthemove</a>.
</div>
<div>
    All code on this site is licensed under the GPLv2. All other
    content is licensed using a creative commons license. See respective license documents for details.
</div>
<?php
require("footer.php");
?>
